var oscError,index,strNaN="NaN",strInf="Infinity",strMathError="Math Error",strEmpty=0,maxLength=8,opCodeArray=[],stackArray=[],trigDisplay="",openArray=[],stackVal1=1,stackVal2=0,opCode=0,stackVal=0,memVal=0,boolClear=!0,newOpCode=0,modeSelected="deg",displayString="",memory=0,trig=0,display="",afterdec="",dS="";function factorial(a){return a>170?strInf:1==a||0==a?1:a<0?strMathError:a%1!=0?gamma(a+1):a*factorial(a-1)}function gamma(a){var e=[.9999999999998099,676.5203681218851,-1259.1392167224028,771.3234287776531,-176.6150291621406,12.507343278686905,-.13857109526572012,9984369578019572e-21,1.5056327351493116e-7];if(a<.5)return Math.PI/Math.sin(a*Math.PI)/gamma(1-a);a--;for(var t=e[0],r=1;r<9;r++)t+=e[r]/(a+r);var s=a+7+.5;return Math.sqrt(2*Math.PI)*Math.pow(s,a+.5)*Math.exp(-s)*t}$(document).ready(function(){$(".keyPad_TextBox1").focus(function(){this.blur()}),$(".keyPad_TextBox").focus(function(){this.blur()}),$.fn.setCursorPosition=function(a){return this.each(function(e,t){if(t.setSelectionRange)t.setSelectionRange(a,a);else if(t.createTextRange){var r=t.createTextRange();r.collapse(!0),r.moveEnd("character",a),r.moveStart("character",a),r.select()}}),this},$("[class^=keyPad_]").each(function(){$(this).click(function(){$("#keyPad_UserInput1").setCursorPosition($("#keyPad_UserInput1").val().length)})});var a=$("#keyPad_UserInput"),e=$("#keyPad_UserInput1"),t=$("input[name=degree_or_radian]:radio:checked").val();function r(t){if(2==stackVal1&&e.val(""),0==stackVal1){opCode=0;var r=1;switch(newOpCode){case 5:r=3;break;case 7:r=5;break;case 8:r=9}e.val().indexOf("e+")>-1||e.val(e.val().substring(0,e.val().length-r)),stackVal2=2}5==stackVal1||2==stackVal2?(stackVal2=0,displayString=e.val()+t):(e.val().indexOf("e+0")>-1&&a.val().indexOf("-")>-1?e.val(e.val().replace("e+0","e")):e.val().indexOf("e+0")>-1&&e.val(e.val().replace("e+0","e+")),displayString=e.val()+a.val()+t)}function s(){for(;opCodeArray[0]&&opCode;)if(10==opCode){if(opCode=opCodeArray[opCodeArray.length-1],stackVal=stackArray[stackArray.length-1],!(1==newOpCode||2==newOpCode||newOpCode<=opCode)){opCode=0;break}opCodeArray.pop(),stackArray.pop()}else{if("{"==stackArray[stackArray.length-1])break;if(l(),"{"==(stackVal=stackArray[stackArray.length-1])){opCode=0;break}if(opCode=opCodeArray[opCodeArray.length-1],!(1==newOpCode||2==newOpCode||newOpCode<=opCode)){opCode=0;break}opCodeArray.pop(),stackArray.pop(),!opCodeArray[0]&&stackArray.length>0&&"{"!=stackArray[stackArray.length-1]&&(stackVal=stackArray[stackArray.length-1])}}function o(){10!=opCode&&0!=opCode&&(opCodeArray.push(opCode),stackArray.push(stackVal)),0==opCode&&stackArray.push(stackVal),opCode=0}function n(){switch(stackVal1){case 2:e.val("");break;case 3:e.val(e.val().substring(0,e.val().length-trigDisplay.length)),stackVal2=4;break;case 5:for(var a="",t=openArray.length;t>=0;t--)a+=displayString.substring(0,displayString.indexOf("(")+1),displayString=displayString.replace(a,"");displayString=a.substring(0,a.lastIndexOf("(")),e.val(displayString),stackVal2=6}}function l(){var a=$("#keyPad_UserInput"),e=parseFloat(a.val()),t=0;switch(opCode){case 9:stackVal=parseFloat(stackVal)*Math.pow(10,e);break;case 1:stackVal+=e;break;case 2:stackVal-=e;break;case 3:stackVal*=e;break;case 4:stackVal/=e;break;case 6:var r=stackVal;stackVal=Math.pow(stackVal,e),10==r&&stackVal%10!=0&&(Math.abs(stackVal)<1e-8||Math.abs(stackVal)>1e8)&&e%1==0&&(stackVal=stackVal.toPrecision(7));break;case 5:stackVal%=e;break;case 7:stackVal=c(stackVal,e);break;case 8:stackVal=Math.log(stackVal)/Math.log(e);break;case 11:stackVal=stackVal/100*e;break;case 0:stackVal=e}if(t=stackVal,Math.abs(t)<1e-8||Math.abs(t)>1e8);else if(t.toFixed(8)%1!=0)for(var s=1;s<10;){if(0!=t.toFixed(s)&&t.toFixed(s)/t.toFixed(s+8)==1){t=t.toFixed(s);break}s++}else t=t.toFixed(0);a.val(t),boolClear=!0,trig=0,a.focus()}function d(a,e){var r="d";"deg"!=t&&(r="r"),i(a+r,e)}function i(a,e){if(1==stackVal2){for(var t="",r=openArray.length;r>=0;r--)t+=displayString.substring(0,displayString.lastIndexOf("(")+1),displayString=displayString.replace(t,"");displayString=t.substring(0,t.lastIndexOf("(")),trigDisplay=a+"("+e+")"}2==stackVal2||3==stackVal1?3==stackVal2?(trigDisplay=a+"("+e+")",stackVal2=2):(displayString=displayString.replace(trigDisplay,""),trigDisplay=a+"("+trigDisplay+")"):(4==stackVal2&&(displayString=""),trigDisplay=a+"("+e+")"),displayString+=trigDisplay}function c(a,e){try{var t=e%2==1&&a<0;t&&(a=-a);var r=Math.pow(a,1/e);return e=Math.pow(r,e),Math.abs(a-e),t?-r:r}catch(a){}}function k(a,e){return"deg"==a?e*(Math.PI/180):"rad"==a?e:void 0}function y(a,e){var t=k(a,e);return t%(Math.PI/2)=="0"?t/(Math.PI/2)%2=="0"?"0":strMathError:Math.tan(t)}function p(a,e){var t=k(a,e);return t.toFixed(8)%(Math.PI/2).toFixed(8)=="0"?(t.toFixed(8)/(Math.PI/2)).toFixed(8)%2=="0"?Math.cos(t):"0":Math.cos(t)}function h(a,e){var t=k(a,e);return 0==(t.toFixed(8)%Math.PI).toFixed(8)?"0":Math.sin(t)}function b(a,e){return"deg"==a?180/Math.PI*e:e}$("#keyPad_UserInput").val(strEmpty),$("div#keyPad a.keyPad_btnNumeric").click(function(){var a=$(this).html(),e=$("#keyPad_UserInput"),t=$("#keyPad_UserInput1");if(!(e.val().indexOf("Infinity")>-1||e.val().indexOf(strMathError)>-1)){boolClear&&(e.val(strEmpty),boolClear=!1);var r=e.val();if(!(r.length>maxLength))return"keyPad_btnDot"==this.id&&r.indexOf(".")>=0&&""!=t.val()?(e.val(strEmpty+"."),void t.val("")):void("keyPad_btnDot"==this.id&&r.indexOf(".")>=0||(n(),r!=strEmpty||r.length>1||"keyPad_btnDot"==this.id?(e.val(r+a),stackVal1=1):(e.val(a),stackVal1=1),e.focus()))}}),$("a.keyPad_btnConst").click(function(){var e=strEmpty,t=$("#keyPad_UserInput");$("#keyPad_UserInput1");if(!(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)){switch(this.id){case"keyPad_btnPi":e=Math.PI;break;case"keyPad_btnPiDiv2":e=Math.PI/2;break;case"keyPad_btnPiDiv3":e=Math.PI/3;break;case"keyPad_btnPiDiv4":e=Math.PI/4;break;case"keyPad_btnPiDiv6":e=Math.PI/6;break;case"keyPad_btnE":e=Math.E;break;case"keyPad_btnInvE":e=1/Math.E;break;case"keyPad_btnSqrt2":e=Math.SQRT2;break;case"keyPad_btnSqrt3":e=Math.sqrt(3);break;case"keyPad_btnCubeRoot2":e=Math.pow(2,1/3);break;case"keyPad_btnLn10":e=Math.LN10;break;case"keyPad_btnLgE":e=Math.LOG10E;break;case"keyPad_btnSigma":e=.69;break;case"keyPad_btnSigma3":e=.007;break;case"keyPad_btnSigma6":e=3.4*Math.pow(10,-6)}n(),stackVal1=1,boolClear=!0,$("#keyPad_UserInput").val(e),t.focus()}}),$("div#keyPad a.keyPad_btnBinaryOp").click(function(){if(!(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)){switch(this.id){case"keyPad_btnPlus":r($("#"+this.id).text()),newOpCode=1,10==opCode&&stackArray.length>0&&"{"==stackArray[stackArray.length-1]&&o(),s(),stackVal1=0;break;case"keyPad_btnMinus":r($("#"+this.id).text()),newOpCode=2,10==opCode&&stackArray.length>0&&"{"==stackArray[stackArray.length-1]&&o(),s(),stackVal1=0;break;case"keyPad_btnMult":r($("#"+this.id).text()),newOpCode=3,1!=opCode&&2!=opCode||o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<3||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_btnDiv":r($("#"+this.id).text()),newOpCode=4,opCode<4&&opCode&&o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<4||5==stackVal1||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_%":r("%"),newOpCode=11,opCode<6&&opCode&&o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<6||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_EXP":r("e+0"),newOpCode=9,opCode<6&&opCode&&o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<6||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=1,stackVal2=7;break;case"keyPad_btnYpowX":r("^"),newOpCode=6,opCode<6&&opCode&&o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<6||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_btnMod":r($("#"+this.id).text()),newOpCode=5,1!=opCode&&2!=opCode||o(),10==opCode&&(opCodeArray[opCodeArray.length-1],o()),stackVal1=0;break;case"keyPad_btnYrootX":r("yroot"),newOpCode=7,opCode<6&&opCode&&o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<6||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_btnYlogX":r("logxBasey"),newOpCode=8,1!=opCode&&2!=opCode||o(),10==opCode&&(opCodeArray[opCodeArray.length-1]<3||stackArray.length>0&&"{"==stackArray[stackArray.length-1]?o():s()),stackVal1=0;break;case"keyPad_btnOpen":displayString=e.val()+$("#"+this.id).text(),newOpCode=0,a.val(0),0!=opCode&&o(),openArray.push("{"),stackArray.push("{"),stackVal1=1;break;case"keyPad_btnClose":if(6==stackVal2?(stackVal=parseFloat(a.val()),displayString=e.val()+a.val()+$("#"+this.id).text()):10!=newOpCode&&3!=stackVal1?(e.val().indexOf("e+0")>-1&&a.val().indexOf("-")>-1?e.val(e.val().replace("e+0","e")):e.val().indexOf("e+0")>-1&&e.val(e.val().replace("e+0","e+")),displayString=e.val()+a.val()+$("#"+this.id).text()):displayString=e.val()+$("#"+this.id).text(),!openArray[0])return;for(openArray.pop(),newOpCode=10;opCodeArray[0]||openArray[0];){if("{"==stackArray[stackArray.length-1]){stackArray.pop();break}if(l(),"{"==(stackVal=stackArray[stackArray.length-1])){stackArray.pop(),opCode=0;break}stackArray.pop(),opCode=opCodeArray[opCodeArray.length-1],opCodeArray.pop(),!opCodeArray[0]&&stackArray.length>0&&"{"!=stackArray[stackArray.length-1]&&(stackVal=stackArray[stackArray.length-1])}stackVal2=1,stackVal1=5;break;case"keyPad_btnPercent":if(1==opCode||2==opCode)a.val(stackVal*parseFloat(a.val())/100);else{if(3!=opCode&&4!=opCode)return;a.val(parseFloat(a.val())/100)}}opCode?l():(stackVal=parseFloat(a.val()),boolClear=!0),opCode=newOpCode,a.focus(),e.val(displayString)}}),$("a.keyPad_btnMemoryOp").click(function(){var e=$("#keyPad_UserInput"),t=parseFloat(e.val());""==e.val()&&(t=0);var r=0;if(!(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)){switch(this.id){case"keyPad_MS":memory=t,$("#memory").addClass("memoryshow"),$("#memory").removeClass("memoryhide"),r=a.val();break;case"keyPad_M+":memory=t+parseFloat(memory),$("#memory").addClass("memoryshow"),$("#memory").removeClass("memoryhide"),r=a.val();break;case"keyPad_MR":r=parseFloat(memory),stackVal1=1;break;case"keyPad_MC":memory=0,$("#memory").removeClass("memoryshow"),$("#memory").addClass("memoryhide"),r=a.val();break;case"keyPad_M-":$("#memory").addClass("memoryshow"),$("#memory").removeClass("memoryhide"),memory=parseFloat(memory)-t,r=a.val()}$("#keyPad_UserInput").val(r),boolClear=!0,e.focus()}}),$("a.keyPad_btnUnaryOp").click(function(){var r=$("#keyPad_UserInput"),s=parseFloat(r.val()),o=oscError;if(!(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)){switch(this.id){case"keyPad_btnInverseSign":o=-s,trig=1,stackVal2=3;break;case"keyPad_btnInverse":o=1/s,i("reciproc",s);break;case"keyPad_btnSquare":o=s*s,i("sqr",s);break;case"keyPad_btnSquareRoot":o=Math.sqrt(s),i("sqrt",s);break;case"keyPad_btnCube":o=s*s*s,i("cube",s);break;case"keyPad_btnCubeRoot":o=c(s,3),i("cuberoot",s);break;case"keyPad_btnLn":o=Math.log(s),i($("#"+this.id).text(),s);break;case"keyPad_btnLg":o=Math.log(s)/Math.LN10,i($("#"+this.id).text(),s);break;case"keyPad_btnExp":o=Math.exp(s),i("powe",s);break;case"keyPad_btnSin":o=h(t,s),d($("#"+this.id).text(),s),trig=1;break;case"keyPad_btnCosin":o=p(t,s),d($("#"+this.id).text(),s),trig=1;break;case"keyPad_btnTg":o=y(t,s),d($("#"+this.id).text(),s),trig=1;break;case"keyPad_btnCtg":o=0==(C=y(t,s))?strMathError:C==strMathError?"0":1/C,d($("#"+this.id).text(),s);break;case"keyPad_btnFact":o=factorial(s),i("fact",s);break;case"keyPad_btn10X":(o=Math.pow(10,s))%10!=0&&(Math.abs(o)<1e-8||Math.abs(o)>1e8)&&s%1==0&&(o=o.toPrecision(7)),i("powten",s);break;case"keyPad_btnAsinH":k=s,o=Math.log(k+Math.sqrt(k*k+1)),d($("#"+this.id).text(),s);break;case"keyPad_btnAcosH":o=Math.log(s+Math.sqrt(s+1)*Math.sqrt(s-1)),d($("#"+this.id).text(),s);break;case"keyPad_btnAtanH":o=.5*(Math.log(1+s)-Math.log(1-s)),d($("#"+this.id).text(),s);break;case"keyPad_btnAbs":o=Math.abs(s),i("abs",s);break;case"keyPad_btnLogBase2":o=Math.log(s)/Math.log(2),i("logXbase2",s);break;case"keyPad_btnAsin":o=function(a,e){var t,r=Math.asin(e);t=strNaN.indexOf(r.toFixed(8))>-1?strMathError:b(a,r);return t}(t,s),d("asin",s),trig=1;break;case"keyPad_btnAcos":o=function(a,e){var t,r=Math.acos(e);t=strNaN.indexOf(r.toFixed(8))>-1?strMathError:b(a,r);return t}(t,s),d("acos",s),trig=1;break;case"keyPad_btnAtan":o=function(a,e){var t,r=Math.atan(e);t=strNaN.indexOf(r.toFixed(8))>-1?strMathError:b(a,r);return t}(t,s),d("atan",s),trig=1;break;case"keyPad_btnSec":o=0==(l=p(t,s)).toFixed(8)?strMathError:1/l;break;case"keyPad_btnCosec":o=0==(n=h(t,s)).toFixed(8)?strMathError:1/n;break;case"keyPad_btnSinH":o=(Math.pow(Math.E,s)-Math.pow(Math.E,-s))/2,d($("#"+this.id).text(),s);break;case"keyPad_btnCosinH":o=(Math.pow(Math.E,s)+Math.pow(Math.E,-s))/2,d($("#"+this.id).text(),s);break;case"keyPad_btnTgH":o=Math.pow(Math.E,s)-Math.pow(Math.E,-s),o/=Math.pow(Math.E,s)+Math.pow(Math.E,-s),d($("#"+this.id).text(),s);break;case"keyPad_btnSecH":o=2/(Math.pow(Math.E,s)+Math.pow(Math.E,-s));break;case"keyPad_btnCosecH":o=2/(Math.pow(Math.E,s)-Math.pow(Math.E,-s));break;case"keyPad_btnOnePlusX":o=1+s;break;case"keyPad_btnOneMinusX":o=1-s}var n,l,k,C;if(1==stackVal2&&(stackVal=o),3!=stackVal2&&(stackVal2=2),stackVal1=3,boolClear=!0,0==o||o==strMathError||o==strInf)r.val(o);else if((Math.abs(o)<1e-8||Math.abs(o)>1e8)&&1!=trig);else if(o.toFixed(8)%1!=0)for(var v=1;v<10;){if(0!=o.toFixed(v)&&o.toFixed(v)/o.toFixed(v+8)==1){o=o.toFixed(v);break}v++}else o=o.toFixed(0);-0==o&&(o=0),r.val(o),trig=0,e.val(displayString),r.focus()}}),$("div.degree_radian").click(function(){t=$("input[name=degree_or_radian]:radio:checked").val()}),$("div#keyPad a.keyPad_btnCommand").click(function(){var a=$("#keyPad_UserInput"),e=$("#keyPad_UserInput1"),t=a.val();switch(this.id){case"keyPad_btnEnter":if(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)return;for(;opCode||opCodeArray[0];)"{"==stackArray[stackArray.length-1]&&stackArray.pop(),l(),stackVal=stackArray[stackArray.length-1],opCode=opCodeArray[opCodeArray.length-1],stackArray.pop(),opCodeArray.pop();return opCode=0,a.focus(),displayString="",trigDisplay="",stackVal=strEmpty,openArray=[],2!=stackVal1&&(3!=stackVal1&&1!=stackVal2||3!=stackVal2&&(t=""),9==newOpCode&&(t.indexOf("-")>-1?e.val(e.val().substring(0,e.val().lastIndexOf("+"))):e.val(e.val().replace("e+0","e+"))),e.val(e.val()+t)),stackVal1=2,newOpCode=0,stackVal2=0,stackArray=[],void(opCodeArray=[]);case"keyPad_btnClr":if(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)return;t==strEmpty?(opCode=0,boolClear=!1):a.val(strEmpty);break;case"keyPad_btnBack":if(1==stackVal1||3==stackVal2){if(t.length>1){if(a.val().indexOf("Infinity")>-1||a.val().indexOf(strMathError)>-1)return;a.val(t.substring(0,t.length-1)),"-"==a.val()&&a.val("0");break}a.val("0");break}break;case"keyPad_btnAllClr":a.val(strEmpty),displayString="",trigDisplay="",stackArray=[],opCodeArray=[],openArray=[],e.val(""),stackVal=strEmpty,stackVal1=1,stackVal2=0,newOpCode=0,opCode=0}})});